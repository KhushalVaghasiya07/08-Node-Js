<%- include("../header") %>

  <div class="page-wrapper">
    <div class="page-breadcrumb">
      <div class="row">
        <div class="col-12 d-flex no-block align-items-center">
          <h4 class="page-title">Add Extra Sub Category</h4>
          <div class="ml-auto text-right">
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">Library</li>
              </ol>
            </nav>
          </div>
        </div>
      </div>
    </div>
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-6">
          <div class="card">
            <form class="form-horizontal" action="/ExtraSubCatagory/AddExtraSubCatagory" method="post">
              <div class="card-body">

                <!-- Category -->
                <div class="form-group row">
                  <label class="col-sm-3 text-right control-label col-form-label">Category</label>
                  <div class="col-sm-9">
                    <select name="catagory" id="category" class="form-control">
                      <option>Select Category</option>
                      <% catagories.forEach((cat)=> { %>
                        <option value="<%= cat._id %>">
                          <%= cat.CatagoryTitle %>
                        </option>
                        <% }) %>
                    </select>
                  </div>
                </div>

                <!-- Sub Category -->
                <div class="form-group row">
                  <label class="col-sm-3 text-right control-label col-form-label">Sub Category</label>
                  <div class="col-sm-9">
                    <select name="subCatagoryTitle" id="subcategory" class="form-control">
                      <option>Select Sub Category</option>
                    </select>
                  </div>
                </div>

                <!-- Extra Sub Category -->
                <div class="form-group row">
                  <label class="col-sm-3 text-right control-label col-form-label">Extra Sub Category</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" name="extraSubCatagoryTitle"
                      placeholder="Enter Extra Sub Category Here...">
                  </div>
                </div>

              </div>
              <div class="border-top">
                <div class="card-body">
                  <button type="submit" class="btn btn-primary">Submit</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <%- include("../footer") %>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        let category = document.getElementById("category");
        let subcategory = document.getElementById("subcategory");

        category.addEventListener('change', () => {
          let categoryId = category.value;
          subcategory.innerHTML = "<option>Select Sub Category</option>";

          fetch(`/SubCatagory/getAllSubCategory?categoryId=${categoryId}`)
            .then(res => res.json())
            .then(data => {
              data.categories.forEach(subCat => {
                let option = document.createElement("option");
                option.setAttribute("value", subCat._id);
                option.innerHTML = subCat.subCatagoryTitle;
                subcategory.appendChild(option);
              });
            })
            .catch(err => console.log(err));
        });
      });
    </script>